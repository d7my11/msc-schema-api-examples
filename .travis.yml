language: generic
if: "(type = push AND branch IN (master, develop)) OR type IN (pull_request, api, cron)"
jdk:
- openjdk8
services:
- docker
before_install:
- curl -L http://dl.bintray.com/snowplow/snowplow-generic/schema_ci_0.2.0.zip | jar xv && chmod +x ./schema-ci

jobs:
  include:
  - stage: Test
    name: Unit Tests
    script: echo "Pretending to run unit tests..."
  - name: Integration Tests
    script: echo "Pretending to run integration tests..."
  - stage: Build
    name: Build
    script: echo "Pretending to build and push artifacts..."
  - stage: Deployment Requirements
    if: branch IN (master, develop)
    name: Check Deployment Requirements
    env:
    - ENV=$(if [ "$TRAVIS_BRANCH" = "master" ]; then echo "PROD"; else echo "DEV"; fi)
    script:
    - './schema-ci check --manifestPath $TRAVIS_BUILD_DIR/snowplow-schemas.json
      --username $USERNAME --password $PASSWORD --environment $ENV 2>/dev/null'
  - stage: Deploy
    if: type = push AND branch IN (master, develop)
    name: Deployment
    script: echo "Prepare deployment..."
    deploy:
      skip_cleanup: true
      provider: script
      script: echo "Pretending to deploy..."
      on:
        condition: type = push AND branch IN (master, develop)
env:
  global:
  - AUTH_SERVER_BASE_URL="https://snowplow-next.eu.auth0.com"
  - API_BASE_URL="https://next.console.snowplowanalytics.com"
  - secure: "G6ifDtuaMIBFBX+glG3Jy7TdEX2FVb9qmUczPawUFA+T8gXWD41P98YCWaq3LrxVfNnofSJwABqHLtg2WOb0n1MJsQd3mvIZk7AgfTMM7TwJYGhph+TcN1FIsv2cX3iD+wTxwkybDbvJYTxz+QFnDN0PhvF2SFJBjyDAwAJ8TeG+R/X42BpDL6sW8W7+XIzOlxuvzuMIeJGxSHMkBbKRhBSo/XQFxtwhhP6Hb1e/PYR/4IoW6SynkKczzvDB7Rr4s8+QcCafTPYp2JkdXuY6OdsyOM4XJtzO+ZzE4R3naiONLnfmAVJ+FeNxv4yEhaR5C/pNevziCLANA7+zM616s79bZjROK8kQ4bmT6C2VbuTBNY4jxpvmxKGxUs+7shAxUEoCGAB1CcR+3yjC6R+EAoPQKTplSTEpO9Jn3PlE000MZw7pjHHR3r/jExbgtFHmcbi5NcRwXi0g2emA3C65TvDJe/ldNbMtBN5TZtY5JxFYMyv9eZs0oQBr42Q63f+4Dx3DOI/HilUev59tPh7FSV3hv8/DiQfC5MK2Zs2ad8BvUKNxEboiAK9tth2H3Q0BkH5+GUSIdQZMGLLfbkN1fuhiA1cNRNt2vYflAISYRho5TYHkXTBo3arX5DfHwr0FjPcbOZIPKdaYYuBFHNVf5nUSW0Dn3DlLnyd0mIHMZkQ="
  - secure: "GrMRxK/0DLI9an2rsBpVxpfNPn9dWfY+De/ZBEdzJjkbHdDnFweDdGSqv0aON5ApBVju4BtmXnqQaD8NTGK29e1wcd5FdkHSo6bxSFk131/Yc8BEONq3KNjy0CglVK7BtqLyqB6AWXUkinh8eIFcJlNVCT9SOVO8c2RxxcoNTdFWDhyRVG8A8PVdh4mbIZtKZgI6W/gbzsxYTI+YVR+w8N7ME15FfKWfPK+FN8ihN24DJvZfiBwwfiI598zuyuLp+3qXPCp68/YU1wh0Y4GKbNbnvnKRWTrB7LpWWm9TUc0Fols79VNlH5DU0J17N3eZhof8jwDAXU/AA3WzITw+XQ11N2/aBx8Ruaqb7DHT5Dcwfucn2mqAkIiJY5aN/Y+qtmQnYmph9EsZOPDwSd2QZeKwkxKBhKhaRjrQ5tH7/5IePJn8I5iCMZ8WOgmMKvGBm127WCawGuYsrkDS9ZNe9galE9CEnThlNxwwq6dTEwvMZZZnO3/uP2EqPvcJJbZY5fRubQJ7vCB5y1iBEtSfjNxhmMzrtGsgVjfwuBY2YXutDfe+JIKptl2SJZA63OUou92e1jdWjApnghKXbXwdllAb84nQmtb6X7qoChr1fGgbBn59H41zCYU6B572xNrMW6XHCKd4rOb9JHXBdTw6WT4O/52eiIs0uyDc1K6JFCw="
  - secure: "hbm2TOKuhQ5AUUM+z3I1VAgviI6LhU56VvXDYMr2etGildS6Tj0J3sIJMeHcgNsXzY0YvJvTw20jVqR0Q4fk7bmnHh2ZGl6O9R44EZ10pQk0LbE8N2xob2X+fkNepI1m08cd3fGtso8POg19X08yRJZ6nIH04OjDwoZH8pmlhSL9tdFV5reneRjFsXk6VySgq4Qpp/tnIMt//OtdjWGSEMckuGzZyWwsXEN9dfB0RQ1ecR8jXGR8Npzg5nk0il9kq7Ip2gLYIJpLXeVIfEJ0byFvNDpAruLxwnR7AF1RhymUdroSIomG+/9iTD2kGri1mFqSjXwjDpDav2ggnVef+8zUhwBqrH5NzsZV1CLdwn7Ogxy6LBTn/QDy6s2OI295FrBFGHH7jub3nLk1AP3N7MhZKishOjz4rxtVsfAhfnN4ImbY9/YLHfhvFwryG6p9arrX4VYBhdfePvjpabb5JWH+5F/XNuTuXLWklBQ8rhQxYTQoH5sAzI/yqGgiaGPrXppeqKVY7pvTHWLHCmjmjdUNlAmwLRIDHRifwvFS7XJ7HajdI8DjF1GFIyTeR2tva4BNRVun4hXO5DFXPX71JRTuKorVpUVsok88zHXb3hfchwbGciChfeII/ubk1CiV/cp1bzKYGSuyrrmvWugmN990q1XQRq73YjvquI2o1gY="
  - secure: "Ltv3YhLBn2L2NzXTfQH1GMpko4DG03ngxJxJIS+e5+gNRDh7OCoR9xmGzDaMpBr2KwU4BweCdtX5aj8LtgfC6mShcVw1+71PgCgARLvGsZ4fX3MfPA6Pg30M7sITwZLDqtzSJQDQ/PQK9T7mDXMUy9Jbp/VmqVNWAHjjdYG8CdBVSUXzSEqRMOBVNdIm62fbyBLrSKBXAHxPLO6xOfDoajnpEdY+hJLYtxAsV1DesddXNB6gug5t5GfTgkXiSm9Ijsvz/GnVcQSSYKlkr/MYaZMP02u0C25LQ7Kh0GW5AHr9+p/vcRzC/fqNU/7XhOvQhgLmHWD87sL6qq6SQtU4M2B3siPIFQ7Qqbz51s/P6sc7i+dDIvCj6J6a8sd+/jwQEhT5ClXjcLrZwEpknJS+Ais97S273bpcrgKLQkCLlugo6mEUu5zXdNaJhkYirP00Tl4b4F2OhJwc7b2zPdH2rfDnPr3XfZRn6eAa8Oa+5AQEKfSIE7CPbWxYJwwcz6rXPEkyfyk3j2nX7xITPO+03DsFQDVdDr1doWqo5JswPClq2KaYnbI7cXI37AlrlylUQsk59qZO4RyhxLfs6SmH4dkAW8ro2W2qT/E7zObJSnkNgRnGgop5butblEo286df/sCIGQ1yKtQIX9jm+7S3D91IKou29gZz7YHGfjzseD0="
  #- secure: "Rt8n/F4MzbD3nIg3Fli+eLXubUDH8b4PggbVDyc8IebssVYO3xl04LvFuqRfj3Cvwf+haTRZgvmgM1pGGWvSgQLISKY05LKLYnCc9Wh391+/P1X4/PX+4gamB3TNg1hmyVu1WuU0yvCqEIZLAJRxJTtjtoPbrIKpdtMjB+H2pNREEy2TpsYMdbvlm6jR2ae8IacPEONCWcY5R+uiFmRCjVaLOWuP8vEWWw3hGCV2+08HUblVFPmun7kxhGsOUZIiH8+yxICxGdDNF6DsZoYWKBIE8AeQIBQJDXs5Xtirns/DAsMV8hji7QA6kBvtkpePSdMD6OrATSpeCXjPhnEt92Bih9t7rZoC/Ah73pumcNMlzJYRpBhvX1uTO2S/cHW/nBE5QKH9oSRXlcT/6nBCM93m7QO52C7+2T0kuT3NeqNHkTNKHaF7TuC1WqMWEpGUUtkbTgj50Vr80ltE01y5J9siFD32roVes8dyavxOnmGEMoC5WL6aXWlfLTiRnO300VA6NpcUFuAeUYa0eeubeu1auqOeylLjNKu/5p5qkrXfvti11V6vs0+N+NarLedXOMp29TYkpLGLsZMFpf8x376AMkrYMi4D4AfZLHkXmyUrECASu6gy3EtWmJGmyS92JQ9djQqZAyVR9/XignoDHp7DSANHooQZO41WXfhefoM="
  #- secure: "kwGGaurPUM1nXbrqb97afXhFeHxnXFh5vz1V8uLF5SsThE97jh6vE6m/xS1WTtQAhl6ihHPTpBXPbpvhLbw92giH0WL7pNYk35FH3ShbEJJCvaxusEBAQiCb1sFCK1R/n4H4p6db8MA7zK42+uPDcJr4PJv9oKqU8bD19zJTmWVkx6RJ/6tm3HjkdaSvJiAHOJkfCeDnVzgKasEP2xW4rkrbhekTiHPcHf4GHTA40ta6PODsxbbQo1W0W71BHuKSXlVVNFKdmuXDnBEPA62j09cDacbnXJjs8ji9WrJhiLLWna6tHOYRoMxqh+72ZvZXq9zqmapIgJ/BHEMvanEviheYs70L440iNYoJwv106fewSCpaJe49SMxXfOtkBKvGGkhu4DxBcgLHPDO+0cVxXUEKy6Hzer85JjwsV2e2hKllfUiWAXdQ/eKPV4NmqAaVgh11W34/SvFuF3BJnGsYsiohh8o6RLeol17ULO0zT0W8kcZSzgprw1vyfaQ0YBGEJz4oTEVyqfn7Tf+pX01kdhOMOpqoEYU+kXsi/h/cKxCx+e72i6mZvEPImKo+zO8JT6fT/Ui6f7waQ0qkyMN+cVbDGT0ylugOAwWniOQOuXqVl2ojtFTbbmQa9AusLz4BqT3y1NEx0uZq36xRItlnOPgbr57F8VsWio6TYOIG5Gk="
  #- secure: "ZEj59nYPLjMbosiBU0yVp8ORExbMoVUaMPgEZLq59UfkdhQ/rKxhiTsW71iQepWCUGSGOamOVttLmqCPt+hqY+JDqmG/yBHxujKreNCu6mkBSnS6+2CZRNUHTxcDJ2k+4+zRR3Cas9JcsJAkLUCeHk6yfx+rLVdgtXCVyz0rlN82qY/fO5P0Xqp59qWSsieDDSipAWmr6dqrJf64ZEyGKTVDwu9mhopfWGJcgFKtxjcNCDfCsHxYCjG3DgWgHguo0oFLuuka9kgZsN08kDZdwC+s1Jr1O33JEDzojgWrhL6FC/i2BJnOZtRBGo6c8yNqWVkA9RZkydWDq0qMekmf32l3BRPOGPda/GSuGu6GB3jigevs6F6pQ67JmY0ANtaGz8jBK84ZshWk9cgV1c209FmZDaxK/G10spMsBWyhr+LHTgP8IPYIPqFt2LPFiMcdX9fGiZ0kdddZ2nQa7DJDa7Xf0tAoImqFAw8Imcchg302nGfsPguKBuWwDQDkTBk7d/ZF4+OpxEN3C/KG+RM4D8RW+twms8HAxKKKn97EgIJ61x5idqkiQQje01AhxlRetApLW2Ee3IBsIXx6CbQgPGbPO1Rm3OToK6o+1Fuy481oZC1uThhwDOWWTD7mOjogCCjIbMcRajMuq3tQI9P7MYScoPbR1oPUer2E12NtVbM="
  #- secure: "C4JLBaigdEVlP7fdRrmGJVTp2w0Pu/qzMiIy/9RUkW6W2N65AF52TgSl1s1aJE5xYgSuewH0QA1ONDH2DLFvJzQTLb3RmLeSQTri6DzX7uRXlZz//Zohyr7EDtn22c/85efgfvjmDvmIZjGx3XvByoDqAEYQzw0MMDQ3idJok/Nrokkt3Tab9XbB7oR+cmtXRX9XskpNPbMV3P1LbmHiaofEYt+OkFAWAd8X5qU/k/nQrTrGNJhSpF+x9N4qlabx0mpPU7CRfYq9k3RuhbEt6IamTnTaAXB42B9VpXCcTBVoKY63cfYtDbECq2mqqrGuTSegeQb0s1JSSDxdQe1h4tM5TRYx4pjTryz52dH8GJbvhgMiBdVWM3ZAa5AVUf4H0SV86gqqZizuqZnHe/vvCc8jPm3bOdCtT9cPnfK9VwA1KwePDzd/Ps3h7UbpjQgRDhqGHAHDX72ZyvYF9hkxi8ronU5YmV13M9yoh0MWm3WOh2rCKoO/VRt6ecfNOkejkhrXhDUlrfEiPU+eQa8AOFkBCqHTbCABwSnGan3GFAxTOq6tY/DBvRUCq6MtnU3VTi0fdaRInRw5rgVAAhE1k6/Zg19S1wBO4me+ElHGn2zE/nNAfPSqAFrBrXVU2gdK6bI7Cqp0DSzT9nZv5G60ikza+34vG6tLDZhqPpJbkqQ="
  